{\rtf1\ansi\ansicpg1252\deff0\nouicompat\deflang1033{\fonttbl{\f0\fnil\fcharset0 Calibri;}}
{\colortbl ;\red0\green0\blue255;\red255\green0\blue0;}
{\*\generator Riched20 10.0.22621}\viewkind4\uc1 
\pard\sa200\sl276\slmult1\b\f0\fs22\lang9 REGISTRY Questions\par
\b0 reg basic 5 \line What PowerShell command will list all the subkeys and contents in the current directory and/or will list all the subkeys and the contents of a directory you specify?\line get-childitem\par
regbasic6\line What PowerShell command will list only the contents of a registry key or subkey?\line get-item\par
reg basic 7\line What registry subkey runs every time the machine reboots? The flag is the full path, using PowerShell.\line HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\par
reg basic 8\line What registry subkey runs every time a user logs on? The flag is the full path, using PowerShell.\line HKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN\par
reg basic 9\line What registry subkey runs a single time, then deletes its value once the machine reboots? The flag is the full path, using PowerShell.\line HKEY_LOCAL_MACHINE\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUNONCE\par
reg basic 10\par
What registry subkey runs a single time, then deletes its value when a user logs on? The flag is the full path, using PowerShell.\par
HKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUNONCE\par
reg basic 11\line What is the suspicious value inside of the registry subkey from your previous challenge named registry_basics_7?\line reg query HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\line malware.exe\par
reg basic 12\line What is the suspicious value inside of the registry subkey that loads every time the "Student" user logs on?\line Get-LocalUser <Username> | Select-Object -ExpandProperty SID\line HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\line c:\\botnet.exe\par
reg basic 13\line What is the value inside of the registry subkey from registry_basics_9?\line HKEY_LOCAL_MACHINE\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUNONCE\line reg query HKEY_LOCAL_MACHINE\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUNONCE\line c:\\virus.exe\par
reg basic 14\line What is the value inside of the registry subkey that loads a single time when the "student" user logs on?\line Get-LocalUser <Username> | Select-Object -ExpandProperty SID\line HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce\line c:\\worm.exe\par
reg basic 15\line Figure out the manufacturer's name of the only USB drive that was plugged into this machine.\line reg query \line HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Enum\\USBstor\line sandisk\par
reg basic 16\line What suspicious user profile, found in the registry, has connected to this machine?\line HKEY_LOCAL_MACHINE\\software\\microsoft\\windows nt\\currentversion\\profilelist\\s-1-5-21-2881336348-3190591231-4063445930-10\line Hasker_McHackerson\par
reg basic 17\line What suspicious wireless network, found in the registry, has this system connected to?\line HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Profiles\line reg query each profile hex to read them; terror_cafe_network (i think)\par
\b Alternate data streams\par
\b0 filesystembasic3\line What PowerShell command will list all files in the current directory, regardless of their attributes?\line get-childitem -force\line\line basic4\line What PowerShell command will give you the sha512 hash of a file?\line get-filehash -algorithm sha512\par
basic5\line What PowerShell command will list permissions of a file?\line get-acl\line\line basic6\line What Windows file maps hostnames to IP addresses?\line C:\\Windows\\System32\\drivers\\etc\\hosts\par
basic 7\line Which group has ReadandExecute (RX) permissions to the file listed in the previous challenge, File_System_Basics_6?\line get-acl -path C:\\Windows\\System32\\drivers\\etc\\hosts | select-object -expandproperty access\line BUILTIN\\Users\line\line basic 8\line Find the last five characters of the MD5 hash of the hosts file\line  certutil -hashfile C:\\Windows\\System32\\drivers\\etc\\hosts md5\line\line basic9\line Examine the readme file somewhere in the CTF user\rquote s home directory.\line search for file using gci -path c:\\users\\ctf -filter readme* -recurse\line 123456\par
basic10\line There is a hidden directory in the CTF user's home directory. The directory contains a file. Read the file.\line ls -force ; cd secretsauce; cat file in dir\line\line basic 11\line Find a file in a directory on the desktop with spaces in it. FLAG is the contents of the file\line ls -recurse; cd z TAB; cat file\line\line basic 12\line Find the Alternate Data Stream in the CTF user's home, and read it.\line Get-ChildItem -Recurse | ForEach-Object \{\line >> Get-Item $_.FullName -Stream *\line >> \} | Where-Object Stream -ne ':$DATA'\line P455W0RD\line\line basic 13\line "Fortune cookies" have been left around the system so that you won't find the hidden password...\line Get-ChildItem -force -Path "C:\\Users\\CTF\\" -Recurse | Select-String -Pattern "fortune" (led to hint used in next command)\line PS C:\\> ls -recurse  "The Fortune Cookie"\line get-item '.\\The Fortune Cookie' -stream * (showed "none" as an ADS)\line cat '.\\The Fortune Cookie' -stream none\line Password: fortune_cookie\line\line basic 14\line There are plenty of phish in the C:\\Users\\CTF, but sometimes they're hidden in plain site.\line ls -force -recurse | select-string -pattern "phi5h"\line ls -recurse -force searching for all files not empty. CAT file"200" for answer\par
\b LINUX BASICS\par
\b0 Basic 2\line For the ls command, what arguments, or switch options, will allow you to print human-readable file sizes in a long-list format?\line ls -lh\line\line basic 4\line What argument/switch option, when used with man, will search the short descriptions and man-page-names for a keyword that you provide?\line man -k\line\line hierarchy\line What is the absolute path to the root directory?\line /\line\line hierarchy2\line What is the absolute path to the default location for configuration files?\line /etc\line\line hierarchy3\line What is the directory that contains executable programs (binaries) which are needed in single user mode, to bring the system up or to repair it?\line /bin\line\line hierarchy4\line What is the absolute path to the directory which contains non-essential binaries that are accessible by standard users as well as root?\line /usr/bin\line\line hierarchy5\line An absolute path to a directory which contains binaries only accessible by the root user, or users in the root group.\line /usr/sbin\line\line hiearchy6\line What is the absolute path for the binary cat man-page?\line man -where(-w) cat\line /usr/share/man/man1/cat.1.gz\par
basic5\line Search the man pages for the keyword digest. Then, use one of the binaries listed to hash the string OneWayBestWay using the largest sha hash available.\line man -k digest\line echo -n OneWayBestWay | sha512sum\line\line basic6\line Use File: /home/garviel/Encrypted\line This file contains encrypted contents. Identify its file type, then decode its contents.\line Hint: Use OpenSSL\line Research: {{\field{\*\fldinst{HYPERLINK https://www.openssl.org/docs/man1.1.1/man1/enc.html }}{\fldrslt{https://www.openssl.org/docs/man1.1.1/man1/enc.html\ul0\cf0}}}}\f0\fs22\par
file Encrypted; unzip ./Encrypted; ID Cipher and symetirc files > cat each;  openssl enc -aes128 -d -in cipher. (used contents of symmetric as the password)\line\line Hierarchy7\line Search the user home directories to find the file with the second-most lines in it. The flag is the number of lines in the file.\line find /home -type f -exec wc -l \{\} + | sort -n\line\line users/groups1\line Read the file that contains the user database for the machine. Identify a strange comment.\line cat /etc/passwd | grep strangecat /etc/passwd | grep garviel (field 5 was the comment field)\line\line users/groups2\line Identify all members of the lodge group. List their names in alphabetical order with a comma in between each name.\line  getent group lodge | sort (must write to file in order to sort)\par
users/groups3\line Find the user with a unique login shell.\line  cut -d: -f7 /etc/passwd | sort -u #this provided unique values of f7 (shell)\line  grep /bin/sh /etc/passwd  #grepped each value to see the unique ones\line\line users/groups4\line Identify the algorithm, the amount of salted characters added, and the length of the hashed password in the file that stores passwords.\line sudo cat /etc/shadow ({{\field{\*\fldinst{HYPERLINK https://www.cyberciti.biz/faq/understanding-etcshadow-file/ }}{\fldrslt{https://www.cyberciti.biz/faq/understanding-etcshadow-file/\ul0\cf0}}}}\f0\fs22 )\line the weblink IDs the unique values from each line of the file\line\b quixos\cf2\b0 :$6$\cf0\b ZMPKtXQ2\b0 $\cf2 PoFwHOkiHYdAo/LQ/gPl6xjkIZ8f/yPxyWXaHPLFXOtnMuNykRsIspIg0MeHFx/gXwTcACeBFd3GotzAgACO50\cf0 :19051:0:99999\line\line permissions1\line Find the directory named Bibliotheca. Enter the absolute path to the directory.\line find / -type d -name "Bibliotheca"\par
permissions2\line Identify the number of users with valid login shells, who can list the contents of the Bibliotheca directory.\line ls -al to show that all can read the directory\line  cat /etc/passwd | grep -vE 'nologin|false' | wc -l (runs the passwd file for valid users "16", the answer is 15 to ignore our nobody from eariler who did not have a valid shell\line\line permissions3\line The permissions that user sejanus has on /media/Bibliotheca, in octal format.\line r=4, w=2, x=1 #\line the user was in the group that owns the dir, they have r-x so 4+1 = 5\line\line permissions4\line Locate the file within /media/Bibliotheca that is modifiable by the only user that is part of the chapter group, but not part of the lodge group.\line compare the users of each group using getent #mephistion is the unique user\line find /media/Bibliotheca -type f -user mephiston -perm /u+w\line\line permissions5\line Identify the file within /media/Bibliotheca where the owning group has more rights than the owning user.\line conduct a ls -lisa in all applicable directories and look for the file that has more group rights then owner\line\line permissions6\line Execute the file owned by the guardsmen group in /media/Bibliotheca, as the owning user.\line The flag is the code name provided after a successful access attempt.\line find /media/Bibliotheca/ -group guardsmen\line look at permissions of each file to see which could be executed\line sudo -u gaunt /media/Bibliotheca/Bibliotheca_quattuor/Tactica_Imperium (must pretend to be file owner in order to execute the file)\line\line permissions7\line The user tyborc is unable to access the directory:\line /media/Bibliotheca/Bibliotheca_unus\line Why? Identify the permission missing in standard verb form.\line Directory is missing execute permissions for that user\line\line permissions8\line Locate the file in /media/Bibliotheca that Quixos has sole modification rights on.\line find /media/Bibliotheca/ -user quixos -exec ls -l \{\} \\;\line  #this syntax finds files owned by quixos and lists permisions\line look for the file that only the owner can write\line\line permissions9\line Find the warp and read its secrets for the flag.\line ls -a for all applicable dirs looking for files starting with a '.'\line cat the file\par
permissions10\line Find the warp and read its secrets for the flag.\line find /media/Bibliotheca/Bibliotheca_duo/ -type f (i knew all warps were under this dir so just looked for file that had warp in name)\line\line regex1\line Using the commands ls and grep, identify the number of directories in /etc/ that end in .d\line  ls -d /etc/*.d | grep '\\.d$' | wc -l  #uses regex to count the dirs that match\line\line regex2\line Use regular expressions to match patterns similar to valid and invalid IP addresses.\line  grep -Ec '\\b[0-9]\{1,3\}\\.[0-9]\{1,3\}\\.[0-9]\{1,3\}\\.[0-9]\{1,3\}\\b' numbers\line\line regex3\line Use regular expressions to match valid IP addresses. The flag is the number of addresses.\line grep -Eo '\\b((25[0-5]|2[0-4][0-9]|1[0-9]\{2\}|[1-9]?[0-9])\\.)\{3\}(25[0-5]|2[0-4][0-9]|1[0-9]\{2\}|[1-9]?[0-9])\\b' number | wc -l\line\line regex4\line Use regular expressions to match patterns that look similar to a MAC Address. Flag is a count of the number of matches\line  grep -E '^([0-9A-Za-z]\{2\}-)\{5\}[0-9A-Za-z]\{2\}$' numbers  |wc -l\line\line Reformat1\line Use awk to print lines:\line >= 420 AND <=1337\line The flag is a SHA512 hash of the output.\line awk 'NR >= 420 && NR <= 1337' numbers | sha512sum\line\line Reformat2\line Use awk to create a separate CSV (comma separated value) file that contains columns 1-6.\line The flag is an MD5 hash of the new file\line Hint: Look at #fields on line 6 in the file to understand column layout.\line Hint: This is a Zeek (formally known as Bro) connection log file in TSV format. Click This Link to learn about its formatting.\line awk -F '\\t' '\{OFS=","; print $1, $2, $3, $4, $5, $6\}' connections | md5sum\par
Regex5\line Use regular expressions to find valid Locally Administered or Universally Administered Unicast MAC addresses.\line Give the count of Locally and Universally Administered MAC addresses as the answer.\line cat numbers | egrep '^([0-9A-Fa-f]\{2\}[:-])\{5\}([0-9A-Fa-f]\{2\})$' | awk -F '-' \{'print $1'\} | awk -F '' \{'print $2'\} | egrep '[048C26AE]' | wc -l\line\line logic3\line Identify heresy by comparing the Inquisition_Targets file to members of the guardsmen group.\line sort Inquisition_Targets > sortinqui.txt (create a sorted file for comparison)\line grep guardsmen /etc/group | awk -F: '\{print$4\}' | tr ',' '\\n' | sort > memsofguards.txt (cleans up the group members from the etc/group file and outputs to a new sorted file)\line comm -12 file1 file2\line\line\b Windows Boot\line\b0 Boot Init 1\line What is the first process to spawn on Windows systems after the kernel loads?\line system\line\line Boot init 2\line What is the Process ID (PID) of the first Windows process?\line 4\line\line boot init 3\line What is the second boot process to spawn, that then spawns csrss in both session 0 and session 1?\line smss.exe\line\line boot init 4\line What session ID do Windows services operate in?\line 0\line\line boot init 5\line What process creates access tokens?\line lsass.exe\line\line boot init 6\line What is the parent process to all svchosts?\line services.exe\line\line boot init 7\line What process is waiting with high priority for the Secure Attention Sequence (SAS)?\line WinLogon\line\line boot init 8\line What user space process spawns explorer, then dies?\line userinit.exe\line\line boot init 9\line What is the name of the bootloader, with extension, we are using on all of the Windows machines in this environment?\line winload.exe\line\line boot init 10\line Based on the boot loader from Init_9, which firmware are we using (BIOS or UEFI) in our environment?\line BIOS\line\line boot init 11\line What file saves the memory state to the hard drive when going into hibernation?\line hiberfil.sys\line\line boot init 12\line What bootloader is responsible for restoring the system to its original state after hibernation?\line winrseume.exe\line\line boot remediate 1 \line The system is booting into safe mode. Identify the flag from the command-line output of the command used to diagnose boot issues.\line bcdedit #to locate the incorrect loader\line 1RF5Zgf9P\line\line boot remediate 2\line The system is booting into safe mode. Correct that, and reboot into the desktop. The flag is on the desktop.\line bcdedit /deletevalue \{current\} safeboot \line shutdown /a\line flag is desktop\line\line boot remediate 3\line windows initializing services system reverting to last known BAD config ...      ;)\line Prevent the system restart using the command line, and then identify persistence mechanisms that are reverting the OS and boot loader configurations.\line The flag is in the same folder as the persistence mechanism\line a bcdedit /enum ALL showed a hint that said persistence was related to the wininit.exe\line i looked at the description of all services in task manager until i found flag\line\line boot remediate 4\line when trying to execute powershell.exe in cmd. the error listed the location and missing file\line dir /S the missing file name system.management.automation.dll\line the flag was in the folder with that file above\line\line boot remediate 5\line Once you fix and launch PowerShell, the console is changed to a custom layout. Figure out what file is causing this, read the file, and inspect the file that it is referencing.\line use powershell testpath to detect if profiles exist\line cat the all all profile\line use start-process on the PDF listed in alluserallhosts\line flag was on one of the slides\par
\b LINUX BOOT\par
\b0 sysv1\line Identify which of your Linux machines is using SysV Initialization.\line ps -p 1 -o comm=    #returned "init" which means sysv\line\line MBR3\line The file /home/bombadil/mbroken is a copy of an MBR from another machine.\line Hash the first partition of the file using md5sum. The flag is the hash.\line dd if=mbroken bs=1 skip=446 count=16 status=none | md5sum\par
MBR4\line The file /home/bombadil/mbroken is a copy of an MBR from another machine.\line You will find the "word" GRUB in the output, hash using md5sum.\line  cat mbroken | xxd -l 512 -g 1 | echo -n GRUB | md5sum\line\line MB5\line Hash only the Bootstrap section of the MBR using md5sum. The flag is the entire hash.\line dd if=mbroken bs=1 count=446 status=none | md5sum (use dd over xxd as dd removes the addressing and fragments that are in a normal hexdump from xxd)\line\line SysV2\line Identify the default run level on the SysV Init Linux machine.\line  cat /etc/inittab\line id:2:initdefault:\par
SysV3\line What is the last script to run when the command init 6 is executed?\line /etc/init.d/reboot\line\line SysD1\line Identify the file that init is symbolically-linked to, on the SystemD init machine.\line cd /sbin\line file init\line init: symbolic link to /lib/systemd/systemd\line\line sysd2\line What is the default target on the SystemD machine and where is it actually located?\line cd /lib/systemd/system\line file default.target\line default.target: symbolic link to graphical.target\line\line sysd3\line What unit does the graphical.target want to start, based solely on its configuration file?\line cat graphical.target | tail -n 8\line\line sysd5\line How many wants does SystemD recognize for only the default.target\line systemctl show --property "Wants" graphical.target\line\line sysd6\line What is the full path to the binary used for standard message logging?\line usr/sbin/rsyslogd\line\line linux grub\line Identify the Linux Kernel being loaded by the Grub, by examining its configuration.\line Enter the command used by the Grub, and the full path to the Kernel, as the flag.\line uname -r shows you the kernel running\line /boot/KERNEL_LIVE_HERE\par
\b Windows Validity\line\b0 basic1\line What Sysinternals tool shows malware persistence locations in tabs within its GUI?\line autoruns\line\line basic2\line What Sysinternals tool is used to investigate processes?\line process explorer\line\line basic 3\line What Sysinternals tool can be used to investigate network connection attempts?\line tcpview\line\line basic 4\line What Sysinternals tool can view permissions?\line accesschk\line\line basic 5 \line What Sysinternals tool allows us to view and modify handles?\line handle\line\line basic6\line What is the default Windows user directory for files downloaded from the internet? The flag is the folder name only.\line downloads\line\line basic 7\line What is the default Windows download directory that everyone has access to? The flag is the absolute path to the directory.\line C:\\Users\\Public\\Downloads\line\line basic 8\line What Sysinternals tool shows service load order\line loadorder\line\line basic 9\line What is the service name of Windows Defender Firewall?\line mpssvc\line\line basic 10\line What SysInternals tool reports .dlls loaded into processes?\line listdlls\line\line hidden process 1\line There is malware on the system that is named similarly to a legitimate Windows executable. There is a .dll in the folder that the malware runs from. The flag is the name of the .dll.\line look in sysinternals "auto run" for odd processes . navigate to filepath\line\line hidden process 2\line You notice that there is an annoying pop up happening regularly. Investigate the process causing it. The flag is the name of the executable.\line using process explorer, look for popups, mcafeefiretray.exe popped up\line\line hidden process 3\line Determine what is sending out a SYN_SENT message. The flag is the name of the executable.\line use TCP view and in the "state" column you can see the SYN_SENT \line\line hidden process 4\line Malware uses names of legit processes to obfuscate itself. Give the flag located in Kerberos\rquote  registry subkey.\line Computer\\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Kerberos\\Parameters\par
hidden process 5\line There is malware named TotallyLegit. Find its binary location and there will be a file in that directory. Read the file.\line look in processexp/autorun for the legit service. cd to file path. cat text file there\line\line hidden process 6\line Find the McAfeeFireTray.exe. There is a file in that directory. The flag is inside.\line same as above\line\line sit aware 1 \line What are the permissions for NT SERVICE\\TrustedInstaller on spoolsv.exe? Copy the permissions from your shell.\line get-process spoolsv | select-object name, id, path\line icacls THE PATH FROM ABOVE COMMAND (F=FULL)\line\line sit aware 2\line What is the PATH listed in the output when we find the handle for spoolsv.exe?\line navigate to C:\\users\\student\\desktop\\sysinternals (this is to run tools from sysint in Powershell)\line .\\handle.exe SPOOLSV\par
sit aware 3\line In what Load Order Group is the Windows Firewall service?\line /PsService.exe query mpssvc (service name of windows firewall)\par
sit aware 4\line What is the first .dll associated with winlogon.exe? Provide the name of the .dll only, not the /absolute/path\line  .\\Listdlls.exe winlogon.exe\line\line sit aware 5\line While examining the Windows Defender Firewall, what is the LogAllowedConnections setting set to, for the Public profile?\line get-netfirewallprofile -profile public\line\line hidden 8\line Determine what mechanism opened the port from hidden_processes_7. The flag is the name of the file.\line use auto runs, knowing that powershell was bad from last problem, file location was listed when clicking the PS entry in autoruns\line\line\b WINDOWS UAC\line\b0 What Sysinternals tool will allow you to view a file's manifest?\line SigCheck\line\line What is the RequestedExecutionLevel for an application to run with the same permissions as the process that started it?\line asinvoker\line\line What RequestedExecutionLevel will prompt the user for Administrator credentials if they're not a member of the Administrator's group\line requireAdministrator\line\line What registry key holds UAC values?\line HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\line\line The flag is the RequestedExecutionLevel of the schtasks.exe file.\line asinvoker\line\line Determine which UAC subkey property shows whether UAC is enabled or not. The flag is the data value in that property.\line get-itemproperty -path "HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" -name enablelua\line\line Provide the name of the UAC [Registry subkey] property that determines what level UAC is set to for admin privileges (Example UAC levels: Default, Always, Notify).\line  get-item -path "HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"\line\line window service\line What command-line (cmd) command will show service information?\line sc query\line\line What command-line (cmd) command will show all services, running or not running?\line sc query state= all\line\line What PowerShell command will list all services?\line get-service\line\line What registry location holds all service data?\line HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\line\line What registry subkey holds a service's .dll location?\line Parameters\line\line Services have a name and display name, which could be different. What is the service name of the only Totally-Legit service?\line get-service -displayname "totally-legit"\par
Figure out the SID of the only Totally-Legit service.\line get-service legit | select-object SID\par
\b Linux Validity\line\b0 Process 2\b\line\b0 How many child processes did SysV Init daemon spawn?\line ps -ppid 1 -lf | wc -l\line\line Process 3\line Identify all of the arguments given to the ntpd daemon (service) using ps.\line ps aux |grep '[n]tpd'\line ntp       1321  0.0  0.0  99876  7936 ?        Ssl  Oct23   0:53 /usr/sbin/ntpd \b -p /var/run/ntpd.pid -g -u 105:109\line\line\b0 Process 5\line Identify the file mapped to the fourth file descriptor (handle) of the cron process.\line pgrep cron - this IDs the cron process id\line cd proc/1302/fd - location of the file descriptors\line sudo ls -l 3 /proc/1302/fd\line flag was 4th path in output\line\line process 6\line Identify the permissions that cron has on the file identified in Processes 5.\line sudo lsof /run/crond.pid\line reference the FG to understand lsof permissions\line\line process 7\line Identify the names of the orphan processes on the SysV system.\line look for a PID of 1 that doesnt make sense in htop or enable the tree (F5) to show the source of the processes as they spawn\line\line process 8 \line Locate zombie processes on the SysV system.\line Identify the zombie processes' parent process.\line look for a state 'Z' in htop. look at the process controlling the zombies\line\line process 9\line Locate the strange open port on the SysV system.\line Identify the command line executable and its arguments.\line ss -ltu \line utilize htop to filter and look for weird port 9999\line\line proc dir 1\line Examine the process list to find the ssh process. Then, identify the symbolic link to the absolute path for its executable in the /proc directory.\line ps aux | grep ssh #this shows the symbolic path\line abolsute path of processes are /proc/PID/exe\line\line proc dir 2\line Identify the file that contains udp connection information. Identify the process using port 123.\line sudo lsof -i :123 - shows open files on the port 123. "name" is the command column to far left\line\line process 10\line Locate the strange open port on the SysV system.\line Identify how the process persists between reboots.\line The flag is the absolute path for the file that contains the persistence mechanism, and the configuration option\line port 9999 ID from htop\line netcat is the keywork\line grep -r netcat in /etc (line with respawn is the crrect line)\line\line proc dir 3\line Identify one of the human-readable file handles by the other program that creates a zombie process.\line use htop to wait for it to spawn zombies\line sudo ls -l /proc/THE PPID OF THE ZOMBIE/fd\line\line Find Evil 1\line Scenario: The Villains group has been chanting offerings to their new leader at regular intervals over a TCP connection.\line Task: Identify their method of communication and how it is occurring. Locate the following artifacts: ** The chant/text used by each villain (include spaces) ** The new Lord receiving the offering ** The IP address and port that the offering is received over\line grep -r offering /etc\line grep -r chant /etc\line the above command searched for and found commands in the test.sh file that say the witchking will ask for offerings and direct other users to chant\b\line\line\b0 Find Evil 2\line Someone or something is stealing files with a .txt extension from user directories. Determine how these thefts are occurring.\line grep -r '*.txt' /lib (created syntax to look for the script that the MCA would be running)\line\b\line\b0 Find Evil 3\line systemctl list-units --type=service (shows all services/failedservices on linux machine)\line found the whatischaos service, \line systemctl cat whatischaos\line grep -r whatischaos /lib\line /lib/systemd/system/whatischaos.service:ExecStart=/bin/bash -c 'netcat -lp 3389 < /tmp/NMAP_all_hosts.txt'\line\line Find Evil 4\line Scenario: The web server has been modified by an unknown hacktivist group. Users accessing the web server are reporting crashes and insane disk usage.\line Task: Identify the Cyber Attack Method used by the group, and the command running.\line ps -elf | grep 443 (looking for all web related services)\line found an exerpt from a script that opened a lp\line grep -r 'lp 443' /lib\line\line Find Evil 5\line Scenario: Analysts have found a dump of commands on the Internet that refer to the Terra machine. The command history for one of the users with an interactive login is being stolen via unknown means. The network analysts can\rquote t find any persistent connections, but notice a spike in traffic on logon and \b logoff\b0 .\line cat ~/.bash_logout\line the script to log and execute malicious logging was in the bash logout file\par
\b Windows Auditing\line\b0 Figure out the last access time of the hosts file.\line Get-ChildItem C:\\Windows\\System32\\drivers\\etc\\hosts | Select-Object Name, LastAccessTime\b\par
\b0 What is the literal path of the prefetch directory?\line C:\\Windows\\Prefetch\line\line recyclebin files\line The first two characters of the filename are $R. This is because the Recycle Bin stores the actual content of the deleted file in a file that begins with $R, followed by a random string of characters. \line $R files: Contain the actual data of the deleted file.\line $I files: Contain metadata about the deleted file, such as its original name and deletion date.\line Filename format: The two files for a single deleted item share the same random string after the initial $R or $I, for example, $R2UW2VL.jfif and $I2UW2VL.jfif. \line\line What main Windows log would show invalid login attempts\line security\line\line What main Windows log will show whether Windows updates were applied recently\line system\line\line When reading logs, you may notice ... at the end of the line where the message is truncated. What format-table switch/argument will display the entire output?\line wrap\line\line files 2\line There is a file that was recently opened that may contain PII.\line Get the flag from the contents of the file\line Get-Item "REGISTRY::HKEY_USERS\\*\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs\\.txt" | select -Expand property | ForEach-Object \{\par
    [System.Text.Encoding]::Default.GetString((Get-ItemProperty -Path "REGISTRY::HKEY_USERS\\*\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs\\.txt" -Name $_).$_)\line\line prefetch2\line gci -path 'c:\\windows\\prefetch\\'\line\line recycle3\line Recover the flag from the Recycle Bin. Enter the name of the recycle bin file that contained the contents of the flag, and the contents of the deleted file. Include the file extension in your answer.\line *Hint: "Dont"\line ls 'C:\\$Recycle.Bin\\' -recurse -verbose -force | select fullname\line ls 'C:\\$Recycle.Bin\\' -recurse -verbose -force | cat \line look for dont\line cat the file to confim filename/flag\line\line jumplists\line Find the file in the jump list location that might allow privilege escalation.\line  cat 'C:\\users\\student\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\AutomaticDestinations\\\line this Dir contained filepaths to inspect. catting the file found from above showed the flag\line\line logs 4\line get-eventlog -logname system | where-object \{$_.message -match "flag"\} | ft -wrap\line\line\b Linux Logging\line\b0 File: /home/garviel/output.xml\line Parse all of the IP addresses from the file using XPATH queries\line xpath -q -e '//address/@addr' /home/garviel/output.xml | md5sum (cat the file first to understand the data youre working with)\line\line Select all of the IP addresses and ports using a single XPATH Union Statement\line xpath -q -e "//address/@addr|//port/@portid" /home/garviel/output.xml | md5sum (key diff is the double quote vs single quote)\line\line File: /home/garviel/conn.log\line Use jq to pretty print the JSON file conn.log.\line Hash the pretty-printed file with md5sum for the flag.\line jq '.' /home/garviel/conn.log  | md5sum\line\line File : /home/garviel/conn.log\line This file is a conn.log made in Zeek (Bro) with data about TCP/IP connections.\line Use jq to locate and count the unique originating endpoint IP addresses in the file. Enter the number of unique originating IP addresses as the flag.\line jq -r '."id.orig_h"' /home/garviel/conn.log | sort | uniq | wc -l\line\line This file is a conn.log made in Zeek (Bro) with data about TCP/IP connections.\line Use jq to locate and count connections where the destination IP sent more than 40 bytes to the source IP.\line jq -c  'select(.resp_bytes > 40)' /home/garviel/conn.log | wc -l (use -c to improve the the processing of the command as it puts all objects to a single line)\line\line\b\par
\par
\b0\line\par
}
 