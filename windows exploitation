#from Op station specify local listening port on RHP (Random High Port) 
ssh student@<JMP_IP> -L RHP:10.10.28.45:3389

#from Op station point xfreerdp to new local listening tunnel
xfreerdp /u:student /v:localhost:RHP /dynamic-resolution /size:3200x1200 +clipboard

DLL Hijacking
reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs"
(search order if dll not in above file)
The directory the the Application was run from
The directory specified in in the C+ function GetSystemDirectory()
The directory specified in the C+ function GetWindowsDirectory()
The current directory

procexplorer
-add column forintegrity level
-User Account control UAC
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System

notepad C:\windows\System32\calc.exe (used to see execution level of an .exe)
<trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
    <security>
        <requestedPrivileges>
            <requestedExecutionLevel
                level="highestAvailable (can also be "as invoker" depending on system need)
eventvwr may needed to be run as admin to show certain security logs

Items to evaluate include:
    Write Permissions (ensure to click the group youre in wehn checking permissions)
    Non-Standard Locations
    Unquoted Executable Paths
    Vulnerabilities in Executables
    Permissions to Run As SYSTEM

schtasks /query /fo LIST /v (GUI: task scheduler)
once you find weird .exe based on criteria above, navigate to its directory and inspect directory to see if you have write perms
PS C:\Users\student.DESKTOP-51TGRU5> icacls C:\Users\student\exercise_2\
C:\Users\student\exercise_2\ BUILTIN\Users:(F)
^^^^^^^^^^^^^^ shows that users have full permission to that dir

DLL HIJACK for REAL
procmon name contains putty, path contains dll, result is name not found
SSPICLI.DLL is deprecated but always loaded

create DLL from FG and tailor command to your needs 
python -m SimpleHTTPServer 8000 (hosted by your linops)
browse to ip:port of linops to download .dll and then insert it into dir with .exe we are hacking
taskkill /IM putty.exe /F 
bad.dll must be renamed to match the name of the dll so that the .exe attempts to call it

VULNERABLE SERVICE
wmic service list full (services.exe)
sc query
INDICATOR IS IF DESCRIPTION IS EMPTY
once found, rename to ensure a copy is present on target box
follow FG steps to tailor malicious executable (double \\ in the winpriv file path)
download from python server > move the file to intended dir 
run or reboot system to ensure service starts








